<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Election Results</title>
     <link rel="icon" href="result.jpg">

    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .results-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .header p {
            margin: 10px 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .candidates-section {
            padding: 40px;
        }

        .candidates-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .candidate-card {
            background: #f8fafc;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            position: relative;
            transition: transform 0.3s ease;
            border: 3px solid transparent;
        }

        .candidate-card:hover {
            transform: translateY(-5px);
        }

        .candidate-card.leading {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #f59e0b;
        }

        .leading-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #f59e0b;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .candidate-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            border: 4px solid white;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .candidate-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .candidate-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2d3748;
            margin: 0 0 10px 0;
        }

        .candidate-party {
            font-size: 1.1rem;
            color: #4a5568;
            margin: 0 0 20px 0;
        }

        .vote-percentage {
            font-size: 3rem;
            font-weight: 800;
            margin: 20px 0;
        }

        .candidate-card:nth-child(1) .vote-percentage {
            color: #3b82f6;
        }

        .candidate-card:nth-child(2) .vote-percentage {
            color: #ef4444;
        }

        .vote-count {
            font-size: 1.1rem;
            color: #6b7280;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 1s ease-out;
        }

        .candidate-card:nth-child(1) .progress-fill {
            background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%);
        }

        .candidate-card:nth-child(2) .progress-fill {
            background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
        }

        .chart-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 16px;
            margin: 40px 0;
        }

        .chart-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 30px;
        }

        .pie-chart {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            position: relative;
        }

        .pie-chart svg {
            transform: rotate(-90deg);
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .winner-section {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .winner-title {
            font-size: 2rem;
            font-weight: 700;
            margin: 0 0 30px 0;
        }

        .winner-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            max-width: 400px;
            margin: 0 auto;
        }

        .winner-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 0 auto 20px;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 3px solid rgba(255,255,255,0.3);
            overflow: hidden;
        }

        .winner-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .winner-name {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0 0 10px 0;
        }

        .winner-details {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .candidates-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .chart-legend {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="results-container">
        <div class="header">
            <h1>üó≥Ô∏è Election Results For Most Favorite Cartoon</h1>
            <p id="reporting">Live results ‚Ä¢ Updated now</p>
        </div>

        <div class="candidates-section">
            <div class="candidates-grid">
                <div class="candidate-card leading" id="candidate1">
                    <div class="leading-badge" id="badge1" style="display:none">üèÜ LEADING</div>
                    <div class="candidate-avatar">
                        <img id="img1" src="pokemon.jpeg" alt="POKEMON" onerror="this.style.display='none'; this.parentElement.innerHTML='üë®‚Äçüíº';">
                    </div>
                    <h2 class="candidate-name" id="name1">POKEMON</h2>
                    <p class="candidate-party" id="party1">HUNGAMA</p>
                    <div class="vote-percentage" id="percent1">0%</div>
                    <div class="vote-count" id="count1">0 votes</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="fill1" style="width: 0%"></div>
                    </div>
                </div>

                <div class="candidate-card" id="candidate2">
                    <div class="candidate-avatar">
                        <img id="img2" src="doreamon.jpeg" alt="DORAEMON" onerror="this.style.display='none'; this.parentElement.innerHTML='üë®‚Äçüíº';">
                    </div>
                    <h2 class="candidate-name" id="name2">DORAEMON</h2>
                    <p class="candidate-party" id="party2">DISNEY CHANNEL</p>
                    <div class="vote-percentage" id="percent2">0%</div>
                    <div class="vote-count" id="count2">0 votes</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="fill2" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <div class="chart-section">
                <h3 class="chart-title">Vote Distribution</h3>
                <div class="pie-chart">
                    <svg width="200" height="200" viewBox="0 0 42 42">
                        <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#e5e7eb" stroke-width="3"></circle>
                        <circle id="pie1" cx="21" cy="21" r="15.915" fill="transparent" stroke="#3b82f6" stroke-width="3" stroke-dasharray="0 100"></circle>
                        <circle id="pie2" cx="21" cy="21" r="15.915" fill="transparent" stroke="#ef4444" stroke-width="3" stroke-dasharray="0 100" stroke-dashoffset="0"></circle>
                    </svg>
                </div>
                <div class="chart-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3b82f6;"></div>
                        <span id="legend1">POKEMON (0%)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ef4444;"></div>
                        <span id="legend2">DORAEMON (0%)</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="winner-section">
            <h2 class="winner-title">üéâ Projected Winner</h2>
            <div class="winner-card">
                <div class="winner-avatar" id="winnerAvatar">
                    <img id="winnerImg" src="pokemon.jpeg" alt="winner" onerror="this.style.display='none'; this.parentElement.innerHTML='üèÜ';">
                </div>
                <h3 class="winner-name" id="winnerName">‚Äî</h3>
                <p class="winner-details" id="winnerDetails">‚Äî</p>
            </div>
        </div>
    </div>

    <script>
        async function fetchResults(){
          const token = localStorage.getItem('token');
          if(!token){ alert('Not verified as admin. Please verify as admin.'); location.href='index.html'; return; }
          try{
            const r = await fetch('/auth/results?token='+encodeURIComponent(token));
            const data = await r.json();
            if(data.status !== 'ok'){ alert(data.message || 'Unauthorized'); location.href='index.html'; return; }
            const p1 = data.percentages.POKEMON || 0;
            const p2 = data.percentages.DORAEMON || 0;
            const c1 = data.POKEMON || 0;
            const c2 = data.DORAEMON || 0;
            document.getElementById('percent1').textContent = p1 + '%';
            document.getElementById('percent2').textContent = p2 + '%';
            document.getElementById('count1').textContent = c1.toLocaleString() + ' votes';
            document.getElementById('count2').textContent = c2.toLocaleString() + ' votes';
            document.getElementById('fill1').style.width = p1 + '%';
            document.getElementById('fill2').style.width = p2 + '%';
            document.getElementById('legend1').textContent = 'POKEMON ('+p1+'%)';
            document.getElementById('legend2').textContent = 'DORAEMON ('+p2+'%)';
            document.getElementById('pie1').setAttribute('stroke-dasharray', p1+' '+p2);
            document.getElementById('pie2').setAttribute('stroke-dasharray', p2+' '+p1);
            document.getElementById('pie2').setAttribute('stroke-dashoffset', '-'+p1);
            const winner = data.winner || 'Tie';
            if(winner === 'POKEMON'){
              document.getElementById('winnerName').textContent = 'POKEMON';
              document.getElementById('winnerDetails').innerHTML = 'HUNGAMA<br>Leading by ' + Math.abs(c1 - c2).toLocaleString() + ' votes';
              document.getElementById('badge1').style.display = 'block';
            } else if(winner === 'DORAEMON'){
              document.getElementById('winnerName').textContent = 'DORAEMON';
              document.getElementById('winnerDetails').innerHTML = 'DISNEY CHANNEL<br>Leading by ' + Math.abs(c2 - c1).toLocaleString() + ' votes';
              const badge = document.createElement('div'); badge.className='leading-badge'; badge.textContent='üèÜ LEADING';
              document.getElementById('candidate2').appendChild(badge);
            } else {
              document.getElementById('winnerName').textContent = 'Tie';
              document.getElementById('winnerDetails').textContent = 'No clear winner yet';
            }
          } catch(e){
            alert('Error loading results: ' + e.message);
          }
        }

        window.addEventListener('load', fetchResults);
    </script>
</body>
</html>
