<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Voting Results</title>
<link rel="icon" href="result.jpg">
<style>
  body { font-family: Inter; background: #eef2f3; text-align: center; padding: 40px; }
  .card { background: white; display:inline-block; padding: 20px 40px; border-radius: 12px; box-shadow:0 6px 20px rgba(0,0,0,0.1); }
  button { margin: 10px; padding:10px 20px; border:none; border-radius:8px; cursor:pointer; color:white; }
  #startBtn { background:#27ae60; } #stopBtn { background:#c0392b; }
</style>
</head>
<body>
  <div class="card">
    <h2>Voting Results</h2>
    <div id="results"></div>
    <button id="startBtn" onclick="startVoting()">Start Voting</button>
    <button id="stopBtn" onclick="stopVoting()">Stop Voting</button>
  </div>

<script>
const backend = "https://cartoon-voting-system.onrender.com";
const token = localStorage.getItem('token');

async function loadResults(){
  const res = await fetch(`${backend}/auth/results?token=${token}`);
  const data = await res.json();
  if(data.status==="ok"){
    document.getElementById('results').innerHTML = `
      <p><b>POKEMON:</b> ${data.POKEMON} votes<br>
      <b>DORAEMON:</b> ${data.DORAEMON} votes<br>
      <b>Total:</b> ${data.total}<br>
      <b>Winner:</b> ${data.winner}</p>
      <p><b>Voting Open:</b> ${data.votingOpen}</p>`;
  } else {
    document.getElementById('results').innerText = data.message;
  }
}

async function startVoting(){
  const res = await fetch(`${backend}/auth/start-voting?token=${token}`, {method:"POST"});
  const data = await res.json();
  alert(data.message); loadResults();
}

async function stopVoting(){
  const res = await fetch(`${backend}/auth/stop-voting?token=${token}`, {method:"POST"});
  const data = await res.json();
  alert(data.message); loadResults();
}

loadResults();
</script>
</body>
</html>
